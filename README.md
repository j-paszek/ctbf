# CTBF: Cancer Tree Biopsy Framework

### Authors: Jaros≈Çaw Paszek, Agnieszka Mykowiecka, Krzysztof Gogolewski

Presented on ISMB/ECCB 2025.

_____

Detailed dscriptions of the project is available here:

[ISMBECCB2025_Long_Abstract_1886](https://j-paszek.github.io/ctbf/ISMBECCB2025_Long_Abstract_1886.pdf)

Graphical overview as a poster:

[ISMBECCB2025_1938_Paszek_poster](https://j-paszek.github.io/ctbf/ISMBECCB2025_1938_Paszek_poster.pdf)

_____

To run CTBF simply run:
`python ctbs.py`

Important note, to run pairwise CNP comparisons we use [cnp2cnp](https://github.com/AEVO-lab/cnp2cnp) tool.
We encourage you to download the tool and set paths `cnp2cnp_FOLDER` and `cnp2cnp_FILE` in `ctbs.py`.

_____

Repository contains:
- source code files:
  - `ctbs.py` - main file
  - `simulator.py` - simulates an evolution of a cancer cell, enables to take biopsy samples, see `Evolution Model` section for more information
  - `reconstructor.py` - reconstructs cancer tree from biopsy samples, see `Tree Reconstruction` section for more information
  - `evaluator.py` - computes similarity between two cancer trees, see `Tree Comparison` section for more information 
- config files (to recreate cancer tree from picture, note in ctbs `run_single_test` uses `seed=727` to omit randomness):
  - `config_for_pic.json` - general config file for the simulator 
  - `pic.csv` - detailed config file for the simulator
- other files (temporal files to generate distances between CNPs of biopsy cells):
  - `biopsy.txt` - file generated as cnp2cnp input
  - `cnp_distance_matrix.txt` - results from cnp2cnp
- plots (see below)

____

Plots (presented on ISMB/ECCB 2025): 

[Simulated tree](https://j-paszek.github.io/ctbf/simulated_tree.html) Cancer cell evolution tree generated by 
simulator basing on the evolution model. Hover over edges to show labels that describe evolutionary events.

[True tree](https://j-paszek.github.io/ctbf/true_tree.html) Simplified simulated tree limited to cells obtained from the biopsy.

[Reconstructed tree](https://j-paszek.github.io/ctbf/reconstructed.html) Tree inferred by our reconstruction 
algorithm, that incorporates information of the cell order from biopsy order.

[NJ tree](https://j-paszek.github.io/ctbf/nj.html) Tree obtained from simple NJ algorithm. 

____
Output:

```Number of biopsy cells:  20
Simulation finished. Generated cell evolution tree total nodes: 73
GRF - reconstructed:  0.1820212058266817
GRF - all nodes NJ :  0.1563342704349393
```

**The evaluation confirms visual observation, that our reconstruction method provides better results than 
NJ algorithm.** 

See `Results` section for detailed experimental evaluation analysis.

____

For more information please contact: j.paszek@uw.edu.pl 

____

Funding:

Financial support was provided by the National Science Center grant no. 2020/39/D/ST6/03321
